@startuml
top to bottom direction

skinparam component {
    BorderColor #1F2A44
    ArrowColor #1F2A44
    BackgroundColor<<ui>> #D8ECFF
    BackgroundColor<<presentation>> #CCE5FF
    BackgroundColor<<service>> #DEF7D9
    BackgroundColor<<data>> #FFECCC
    BackgroundColor<<db>> #FFE2E2
}

title Layered Architecture (React ↔ Spring Boot)

package "Frontend UI Layer (React/Vite)" <<ui>> {
    [App.tsx] as APP
    [Screen Components\n(Login, Dashboard,\nWorkoutLog, GoalSetting,\nProfile)] as SCREENS
    [api.ts HTTP Client] as API
    APP --> SCREENS
    SCREENS --> API : fetch JSON
}

package "Presentation Layer (Controllers)" <<presentation>> {
    [UserController]
    [WorkoutController]
    [GoalController]
}

package "Application Layer (Services)" <<service>> {
    [UserService\n<<interface>>] as UserService
    [UserServiceImpl] as UserServiceImpl
    [WorkoutService\n<<interface>>] as WorkoutService
    [WorkoutServiceImpl] as WorkoutServiceImpl
    [GoalService\n<<interface>>] as GoalService
    [GoalServiceImpl] as GoalServiceImpl
    
    UserService <|.. UserServiceImpl
    WorkoutService <|.. WorkoutServiceImpl
    GoalService <|.. GoalServiceImpl
}

package "Data Access Layer (Mappers + Repositories)" <<data>> {
    [UserMapper] as UM
    [WorkoutMapper] as WM
    [GoalMapper] as GM
    [ExerciseMapper] as EM
    
    [UserRepository] as UR
    [WorkoutRepository] as WR
    [GoalRepository] as GR
    
    [DTOs\n(UserDTO, WorkoutDTO,\nGoalDTO, ExerciseDTO)] as DTOs
    [Entities\n(User, Workout, Goal, Exercise)] as ENT
    
    UM --> DTOs
    WM --> DTOs
    GM --> DTOs
    EM --> DTOs
    
    UM --> ENT
    WM --> ENT
    GM --> ENT
    EM --> ENT
}

database "PostgreSQL" <<db>> as DB {
    [users / workouts / goals / exercises]
}

' ===== Layer-to-layer connectors =====
API --> [UserController] : HTTP/REST\nJSON payloads
API --> [WorkoutController]
API --> [GoalController]

[UserController] --> UserService : invoke service API
[WorkoutController] --> WorkoutService
[GoalController] --> GoalService

UserService --> UserServiceImpl
WorkoutService --> WorkoutServiceImpl
GoalService --> GoalServiceImpl

UserServiceImpl --> UM
UserServiceImpl --> UR

WorkoutServiceImpl --> WM
WorkoutServiceImpl --> EM
WorkoutServiceImpl --> WR
WorkoutServiceImpl --> UR

GoalServiceImpl --> GM
GoalServiceImpl --> GR
GoalServiceImpl --> UR

UR --> DB : CRUD via Spring Data JPA
WR --> DB
GR --> DB

note bottom
    Layering rules enforced:
    • React UI only talks to controllers over HTTP.
    • Controllers call service interfaces only.
    • Services orchestrate business rules and rely on data layer helpers (mappers+repositories).
    • Repositories encapsulate persistence and are the only layer hitting PostgreSQL.
end note

@enduml


